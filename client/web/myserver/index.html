<!DOCTYPE html>
<html lang="en">
<head>
    <title>HotCit</title>
    <script src="js/jquery-2.0.3.js"></script>
    <script src="js/underscore-1.1.6.js"></script>
    <script src="js/backbone.js"></script>
    <script src="js/mustache.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap-theme.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>
    <script src="js/ServerDao.js"></script>
    <script src="js/Simulate.js"></script>
    <script src="js/OptionsView.js"></script>
    <script src="js/ChangePlayerView.js"></script>
    <script src="js/GameModel.js"></script>
    <script>
    $(document).ready(function() {
        function print() { console.log(arguments) }
        function printBody() { console.log("body: ", arguments[0]) }
        function printOptions(body, playerid) { console.log("options: " + playerid + ":", arguments[0]); }
        
        function dummy() {  }
        var error = function(gameid, playerid) {
            return function() {
                gameAPI.get.options(gameid, playerid, printOptions, error);
                console.error(arguments);
            }
        };
        var success = dummy;
        
        var playernames = [ "ada", "turing", "hopper", "wiener" ]; 
            
        var gameid = simulate.lobby(playernames, success, error);
        simulate.characterselect(gameid, success, error);    
        
        // FIRST TURN
        // why send source, seems unneccessary, maybe nice for debuging?
        // getHand(gameid, players[2], print, error(gameid, players[2]));
        // gameAPI.getOptions(gameid, players[2], printOptions, error(gameid, players[2]));

        // should be allowed! (and required action to do first)
        // gameAPI.do.ability(gameid, players[2], "assassin", "merchant", success, error(gameid, players[2]));
        // console.log("do actions");
        // gameAPI.do.takeGold(gameid, players[2], success, error(gameid, players[2]));
        // gameAPI.get.options(gameid, players[0], printOptions, error(gameid, players[0]));
        // gameAPI.get.options(gameid, players[1], printOptions, error(gameid, players[1]));
        // gameAPI.get.options(gameid, players[2], printOptions, error(gameid, players[2]));
        // gameAPI.get.options(gameid, players[3], printOptions, error(gameid, players[3]));
        
        // nobody has any cards in their hands!
        //gameAPI.get.hand(gameid, players[2], print, error(gameid, players[2]));

        //gameAPI.doBuild(gameid, players[2], "castle", success, error(gameid, players[2]));
        //gameAPI.do.endTurn(gameid, players[2], success, error(gameid, players[2]));
        //gameAPI.get.options(gameid, players[2], printOptions, error(gameid, players[2]));
        //gameAPI.get.hand(gameid, players[2], print, error(gameid, players[2]));
        
        var model = new GameModel(gameid, 'ada');
        model.update();
        
        var changePlayerView = new ChangePlayerView(model, "#changeplayerBtn");
        changePlayerView.render();
        var optionsView = new OptionsView(model, '#options', '#myModal', '.modal-body', '#options_view') 
        optionsView.render();
    });
    </script>
    
    <script id="options_view" type="text/html">
        <li>
            <button type='button' class='btn btn-primary' style='width:100%; white-space: normal;'>
                {{Message}}
            </button>
        </li>
    </script>


</head>
<body class='container'>
    <div class='row'>
        <h1>TODO</h1>
        <p>do stuff</p>
        <div class='well' style='width:200px;'>
            <button type='button' id='changeplayerBtn' class='btn btn-primary' style='width:100%; white-space: normal;'>change player</button>
        </div>
        <div class='well' style='width:200px;'>
            <ul class='nav nav-pills nav-stacked' id='options'></ul>
        </div>
    </div>
</body>


<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Please select a card</h4>
      </div>
      <div class="modal-body">
        Did you know assassin is spelled with a lot of s's?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary">Assassinate</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

</html>
